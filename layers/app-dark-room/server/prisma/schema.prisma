generator client {
  provider = "prisma-client-js"
  output   = "../../../../node_modules/@prisma/dark-room" 
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL_DUCK_BEAUTY_SERVICE")
}

// üî• Collection: Confession
// üëâ L∆∞u n·ªôi dung t√¢m s·ª± ·∫©n danh ƒë∆∞·ª£c ng∆∞·ªùi d√πng chia s·∫ª.
// üëâ Ng∆∞·ªùi d√πng kh√°c c√≥ th·ªÉ xem, mua, tip ho·∫∑c t∆∞∆°ng t√°c.
model Confession {
  id           String      @id @default(auto()) @map("_id") @db.ObjectId
  userId       String      @db.ObjectId
  content      Json        // N·ªôi dung ƒë·∫ßy ƒë·ªß
  summary      String      // T√≥m t·∫Øt
  totalViews   Int         @default(0)
  tags         String[]
  isApproved   Boolean     @default(false)
  isAnonymous  Boolean     @default(true)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  reactions    Reaction[]
  comments     Comment[]

  @@index([tags])
}

// üî• Collection: Reaction
// üëâ L∆∞u th√¥ng tin t∆∞∆°ng t√°c c·∫£m x√∫c (like, heart, wow...) v·ªõi confession.
model Reaction {
  id            String      @id @default(auto()) @map("_id") @db.ObjectId
  confessionId  String      @db.ObjectId
  userId        String      @db.ObjectId
  type          String      // like, heart, shock, etc.
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  confession    Confession  @relation(fields: [confessionId], references: [id])
}

// üí¨ Collection: Comment
// üëâ B√¨nh lu·∫≠n c·ªßa ng∆∞·ªùi d√πng ƒë·ªëi v·ªõi confession.
model Comment {
  id            String      @id @default(auto()) @map("_id") @db.ObjectId
  confessionId  String      @db.ObjectId
  userId        String      @db.ObjectId
  content       Json                                       // N·ªôi dung b√¨nh lu·∫≠n (plain text)
  isAnonymous   Boolean     @default(true)                   // C√≥ ·∫©n danh kh√¥ng?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  confession    Confession  @relation(fields: [confessionId], references: [id])
}